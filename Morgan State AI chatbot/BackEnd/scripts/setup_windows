# Morgan AI Backend Setup Script for Windows
Write-Host "Setting up Morgan AI Backend..." -ForegroundColor Green

# Navigate to backend directory
$BackendPath = "C:\Users\paule\OneDrive\Desktop\Morgan State AI chatbot\BackEnd"
Set-Location $BackendPath

# Create virtual environment
Write-Host "Creating virtual environment..." -ForegroundColor Yellow
python -m venv venv

# Activate virtual environment
Write-Host "Activating virtual environment..." -ForegroundColor Yellow
& .\venv\Scripts\Activate.ps1

# Upgrade pip
Write-Host "Upgrading pip..." -ForegroundColor Yellow
python -m pip install --upgrade pip

# Install dependencies
Write-Host "Installing dependencies..." -ForegroundColor Yellow
pip install -r requirements.txt

# Create .env file if it doesn't exist
if (-Not (Test-Path .env)) {
    Write-Host "Creating .env file..." -ForegroundColor Yellow
    Copy-Item .env.example .env
    Write-Host "Please edit .env file with your API keys" -ForegroundColor Red
    notepad .env
}

# Initialize Pinecone
Write-Host "Initializing Pinecone..." -ForegroundColor Yellow
python scripts/setup_pinecone.py

# Ingest knowledge base
Write-Host "Ingesting knowledge base..." -ForegroundColor Yellow
python scripts/ingest_data.py

# Start the server
Write-Host "Starting backend server..." -ForegroundColor Green
python -m app.main